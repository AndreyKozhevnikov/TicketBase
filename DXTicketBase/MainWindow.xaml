<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:DXTicketBase"
    xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
    xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
    xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
    xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
    xmlns:dxgt="http://schemas.devexpress.com/winfx/2008/xaml/grid/themekeys"
    x:Class="DXTicketBase.MainWindow"
    Title="TICKETS BASE" Height="700" Width="1100"
    SnapsToDevicePixels="True" UseLayoutRounding="True"
    x:Name="ico" Icon="0196.ico" 
    Closed="ico_Closed"
    >
    <Window.Resources>
        <Style x:Key="TicketStyle" TargetType="{x:Type dxg:RowControl}">
            <Style.Triggers>
                <DataTrigger Binding="{Binding Row.IsSaved}" Value="False">
                    <Setter Property="Background" Value="Pink"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>
    <dxmvvm:Interaction.Behaviors>
        <dxmvvm:EventToCommand Command="{Binding WindowLoadedCommand}" EventName="Loaded" PassEventArgsToCommand="True"/>
        <local:ManageGridControlService MyTableView="{Binding ElementName=TableView1}"/>
    </dxmvvm:Interaction.Behaviors>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        <dxg:GridControl  ItemsSource="{Binding ListTickets}" Name="gridControlTickets" Grid.Row="0" CurrentItem="{Binding SelectedTicket, Mode=TwoWay}"
                         
                          >
            <dxg:GridControl.Columns>
                <dxg:GridColumn FieldName="Number" Width="30"/>
                <dxg:GridColumn FieldName="Subject"/>
                <dxg:GridColumn FieldName="Comment"/>
                <dxg:GridColumn FieldName="AddDate"/>
            </dxg:GridControl.Columns>
            <dxg:GridControl.View>
                <dxg:TableView ShowTotalSummary="True"   x:Name="TableView1"
                                           AutoWidth="True" AllowEditing="False" 
                                           RowStyle="{StaticResource TicketStyle}" 
                               SearchString="{Binding SearchStringVM,Mode=TwoWay}"
                                           >
                    <dxmvvm:Interaction.Behaviors>
                        <dxmvvm:EventToCommand EventName="CopyingToClipboard"
                                               Command="{Binding CopyToClipBoardCommand}"
                                               PassEventArgsToCommand="True"/>
                    </dxmvvm:Interaction.Behaviors>
                </dxg:TableView>
            </dxg:GridControl.View>

        </dxg:GridControl>
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition />
                <ColumnDefinition />
            </Grid.ColumnDefinitions>
            <StackPanel Grid.Column="0">
                <dxe:TextEdit  EditValue="{Binding ThisTicket.ComplexSubject, Mode=TwoWay}" Height="80" Margin="0,0,0,50" />
                <Button Content="AddNewTicket" Height="60" Margin="0,0,0,50">
                    <dxmvvm:Interaction.Behaviors>
                        <dxmvvm:EventToCommand EventName="Click" Command="{Binding AddNewTicketCommand}" />
                    </dxmvvm:Interaction.Behaviors>
                </Button>
                <Button Content="Create and open a solution"  Height="50">
                    <dxmvvm:Interaction.Behaviors>
                        <dxmvvm:EventToCommand EventName="Click" Command="{Binding CreateAndOpenSolutionCommand}" />
                    </dxmvvm:Interaction.Behaviors>
                </Button>
            </StackPanel>
            <StackPanel Grid.Column="1" Margin="10,0,0,0">
                <dxe:TextEdit Text="{Binding SelectedTicket.Comment}"  TextWrapping="Wrap" Height="30" Margin="0,0,0,10"/>
                <Button Content="saveall" Height="30" Margin="0,0,0,20">
                    <dxmvvm:Interaction.Behaviors>
                        <dxmvvm:EventToCommand EventName="Click" Command="{Binding SaveAllCommand}"/>
                    </dxmvvm:Interaction.Behaviors>
                </Button>
                <Button Content="GoToWeb" Height="30">
                    <dxmvvm:Interaction.Behaviors>
                        <dxmvvm:EventToCommand EventName="Click" Command="{Binding GoToWebCommand}"/>
                    </dxmvvm:Interaction.Behaviors>
                </Button>
            </StackPanel>
            
            
            
            

       
            
        </Grid>
    </Grid>

</Window>